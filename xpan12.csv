
/*
---------------------------------------
# ✅ xpan012
# ✅ Pandas criado: 2021/08/11
# ✅ Objetivo:sql server - PANDAS Lib
---------------------------------------*/
CREATE proc [dbo].[xpan012]
AS
/*
#--------------------------------------
# PANDAS - Tutorial X1PAN12 2021/08/01     
#---------------------------------------
import seaborn as sns
df = sns.load_dataset('diamonds')
df.head()
carat	cut	color	clarity	depth	table	price	x	y	z
0	0.23	Ideal	E	SI2	61.5	55.0	326	3.95	3.98	2.43
1	0.21	Premium	E	SI1	59.8	61.0	326	3.89	3.84	2.31
2	0.23	Good	E	VS1	56.9	65.0	327	4.05	4.07	2.31
3	0.29	Premium	I	VS2	62.4	58.0	334	4.20	4.23	2.63
4	0.31	Good	J	SI2	63.3	58.0	335	4.34	4.35	2.75

df.shape
(53940, 10)
df.dtypes
carat       float64
cut        category
color      category
clarity    category
depth       float64
table       float64
price         int64
x           float64
y           float64
z           float64
dtype: object

# Seaborn allows you to load any dataset from GIT using the load_dataset ()
sns.get_dataset_names () 
['anagrams',
 'anscombe',
 'attention',
 'brain_networks',
 'car_crashes',
 'diamonds',
 'dots',
 'exercise',
 'flights',
 'fmri',
 'gammas',
 'geyser',
 'iris',
 'mpg',
 'penguins',
 'planets',
 'tips',
 'titanic']

for nome,valores in df.iteritems():
    break
valores
0        0.23
1        0.21
2        0.23
3        0.29
4        0.31
         ... 
53935    0.72
53936    0.72
53937    0.70
53938    0.86
53939    0.75
Name: carat, Length: 53940, dtype: float64

for _,valores in df.iteritems():
    break
valores
0        0.23
1        0.21
2        0.23
3        0.29
4        0.31
         ... 
53935    0.72
53936    0.72
53937    0.70
53938    0.86
53939    0.75
Name: carat, Length: 53940, dtype: float64

valores.mode()
0    0.3
dtype: float64

modadic = {}
for nome, valores in df.iteritems():
    modadic[nome] = valores.mode()[0]
modadic
{'carat': 0.3,
 'cut': 'Ideal',
 'color': 'G',
 'clarity': 'SI1',
 'depth': 62.0,
 'table': 56.0,
 'price': 605,
 'x': 4.37,
 'y': 4.34,
 'z': 2.7}

valores = []
for indice, linha in df.iterrows():
    valores.append('barato' if linha['price'] <=1000 else 'caro')
df['custo'] = valores
df
carat	cut	color	clarity	depth	table	price	x	y	z	custo
0	0.23	Ideal	E	SI2	61.5	55.0	326	3.95	3.98	2.43	barato
1	0.21	Premium	E	SI1	59.8	61.0	326	3.89	3.84	2.31	barato
2	0.23	Good	E	VS1	56.9	65.0	327	4.05	4.07	2.31	barato
3	0.29	Premium	I	VS2	62.4	58.0	334	4.20	4.23	2.63	barato
4	0.31	Good	J	SI2	63.3	58.0	335	4.34	4.35	2.75	barato
...	...	...	...	...	...	...	...	...	...	...	...
53935	0.72	Ideal	D	SI1	60.8	57.0	2757	5.75	5.76	3.50	caro
53936	0.72	Good	D	SI1	63.1	55.0	2757	5.69	5.75	3.61	caro
53937	0.70	Very Good	D	SI1	62.8	60.0	2757	5.66	5.68	3.56	caro
53938	0.86	Premium	H	SI2	61.0	58.0	2757	6.15	6.12	3.74	caro
53939	0.75	Ideal	D	SI2	62.2	55.0	2757	5.83	5.87	3.64	caro
53940 rows × 11 columns
*/